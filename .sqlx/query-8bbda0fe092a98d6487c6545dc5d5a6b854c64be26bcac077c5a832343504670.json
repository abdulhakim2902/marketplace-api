{
  "db_name": "PostgreSQL",
  "query": "\n            WITH\n              wallet_nfts AS (\n                  SELECT n.owner, COUNT(*) FROM nfts n\n                  WHERE n.owner = $1\n                  GROUP BY n.owner\n              ),\n              traded_activities AS (\n                  SELECT\n                      ra.receiver                       AS address, \n                      SUM(COALESCE(ra.usd_price, 0))    AS trade_volumes, \n                      SUM(\n                          CASE\n                              WHEN ra.tx_type = 'buy' OR (ra.tx_type = 'mint' AND ra.price > 0) THEN 1\n                              ELSE 0 \n                          END\n                      )                                 AS total_buys,\n                      AVG(\n                        EXTRACT(EPOCH FROM ra.block_time) - \n                            COALESCE(EXTRACT(EPOCH FROM sa.block_time), EXTRACT(EPOCH FROM ra.block_time))\n                      )                                 AS holding_periods\n                  FROM activities ra\n                      LEFT JOIN activities sa ON ra.sender = sa.receiver AND ra.nft_id = sa.nft_id AND ra.collection_id = sa.collection_id\n                  WHERE ra.receiver = $1 \n                      AND ra.sender IS NOT NULL\n                      AND ra.tx_type IN ('transfer', 'buy', 'mint')\n                  GROUP BY ra.receiver\n              )\n            SELECT\n                wn.count            AS unique_nfts,\n                ta.total_buys,\n                ta.trade_volumes,\n                ta.holding_periods\n            FROM wallets w\n                JOIN wallet_nfts wn ON wn.owner = w.address\n                JOIN traded_activities ta ON ta.address = w.address\n            WHERE w.address = $1\n            ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "unique_nfts",
        "type_info": "Int8"
      },
      {
        "ordinal": 1,
        "name": "total_buys",
        "type_info": "Int8"
      },
      {
        "ordinal": 2,
        "name": "trade_volumes",
        "type_info": "Numeric"
      },
      {
        "ordinal": 3,
        "name": "holding_periods",
        "type_info": "Numeric"
      }
    ],
    "parameters": {
      "Left": [
        "Text"
      ]
    },
    "nullable": [
      null,
      null,
      null,
      null
    ]
  },
  "hash": "8bbda0fe092a98d6487c6545dc5d5a6b854c64be26bcac077c5a832343504670"
}
